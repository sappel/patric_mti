<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>poisson_xy.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>poisson_xy.cpp</h1><div class="fragment"><pre>00001 <span class="preprocessor">#include "Constants.h"</span>
00002 <span class="preprocessor">#include "Definitions.h"</span>
00003 <span class="preprocessor">#include "mathtools.h"</span>
00004 
00005 <span class="keywordtype">void</span> poisson_xy(<span class="keywordtype">float</span>* cdensity, <span class="keywordtype">int</span> NX, <span class="keywordtype">int</span> NY, <span class="keywordtype">float</span> dx, <span class="keywordtype">float</span> dy)
00006 {
00007  <span class="keywordtype">int</span> j, l;
00008  <span class="keywordtype">float</span> *temx, *temy;
00009  temx=<span class="keyword">new</span> <span class="keywordtype">float</span>[NX];
00010  temy=<span class="keyword">new</span> <span class="keywordtype">float</span>[NY]; 
00011 
00012  <span class="keywordflow">for</span>(j=0; j&lt;NX; j++)
00013    {  
00014     <span class="keywordflow">for</span>(l=0;l&lt;NY;l++)
00015      temy[l]=cdensity[l+NY*j];
00016     sinft(temy-1,NY);
00017     <span class="keywordflow">for</span>(l=0;l&lt;NY;l++)
00018      cdensity[l+NY*j]=temy[l];
00019    }
00020  
00021  <span class="keywordflow">for</span>(l=0; l&lt;NY; l++)
00022    {
00023     <span class="keywordflow">for</span>(j=0;j&lt;NX;j++)
00024      temx[j]=cdensity[l+j*NY];
00025     sinft(temx-1,NX);
00026     <span class="keywordflow">for</span>(j=0;j&lt;NX;j++)
00027      cdensity[l+NY*j]=temx[j];
00028    }
00029  
00030   <span class="keywordflow">for</span>(j=1;j&lt;NX;j++)
00031    <span class="keywordflow">for</span>(l=1;l&lt;NY;l++)
00032      cdensity[l+j*NY]*=-1.0/eps0             
00033                   *0.5*dx*dy/(cos(PI*j/NX)+cos(PI*l/NY)-2.0); 
00034                   
00035  <span class="keywordflow">for</span>(j=0; j&lt;NX; j++)
00036   {
00037    <span class="keywordflow">for</span>(l=0;l&lt;NY;l++)
00038     temy[l]=cdensity[l+NY*j];   
00039    sinft(temy-1,NY);
00040    <span class="keywordflow">for</span>(l=0;l&lt;NY;l++)
00041      cdensity[l+NY*j]=2.0*temy[l]/NY;   
00042   }
00043  
00044  <span class="keywordflow">for</span>(l=0; l&lt;NY; l++)
00045    {
00046     <span class="keywordflow">for</span>(j=0;j&lt;NX;j++)
00047      temx[j]=cdensity[l+j*NY];
00048     sinft(temx-1,NX);
00049     <span class="keywordflow">for</span>(j=0;j&lt;NX;j++)
00050      cdensity[l+NY*j]=2.0*temx[j]/NX;
00051    }
00052 
00053  <span class="keyword">delete</span> temx;
00054  <span class="keyword">delete</span> temy;
00055  
00056 }
</pre></div><hr><address style="align: right;"><small>Generated on Mon Feb 21 10:22:20 2005 for Track by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3 </small></address>
</body>
</html>
