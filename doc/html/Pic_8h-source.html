<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Pic.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>Pic.h</h1><div class="fragment"><pre>00001 
00002 
00004 
<a name="l00005"></a><a class="code" href="structParticle.html">00005</a> <span class="keyword">struct </span><a class="code" href="structParticle.html">Particle</a> {
<a name="l00007"></a><a class="code" href="structParticle.html#m2">00007</a>  <span class="keywordtype">double</span> <a class="code" href="structParticle.html#m0">x</a>, <a class="code" href="structParticle.html#m1">y</a>, <a class="code" href="structParticle.html#m2">z</a>; 
<a name="l00009"></a><a class="code" href="structParticle.html#m5">00009</a>  <span class="keywordtype">double</span> <a class="code" href="structParticle.html#m3">dp</a>, <a class="code" href="structParticle.html#m4">xs</a>, <a class="code" href="structParticle.html#m5">ys</a>;
<a name="l00011"></a><a class="code" href="structParticle.html#m9">00011</a>  <span class="keywordtype">double</span> <a class="code" href="structParticle.html#m6">x1</a>, <a class="code" href="structParticle.html#m7">xs1</a>, <a class="code" href="structParticle.html#m8">x2</a>, <a class="code" href="structParticle.html#m9">xs2</a>; 
<a name="l00013"></a><a class="code" href="structParticle.html#m13">00013</a>  <span class="keywordtype">double</span> <a class="code" href="structParticle.html#m10">y1</a>, <a class="code" href="structParticle.html#m11">ys1</a>, <a class="code" href="structParticle.html#m12">y2</a>, <a class="code" href="structParticle.html#m13">ys2</a>; 
<a name="l00015"></a><a class="code" href="structParticle.html#m16">00015</a>  <span class="keywordtype">double</span> <a class="code" href="structParticle.html#m14">lambda_h</a>, <a class="code" href="structParticle.html#m15">lambda_tmp_h</a>, <a class="code" href="structParticle.html#m16">lambda_v</a>, <a class="code" href="structParticle.html#m17">lambda_tmp_v</a>; 
00016 };
00017 
00018 
00020 
<a name="l00021"></a><a class="code" href="structSynParticle.html">00021</a> <span class="keyword">struct </span><a class="code" href="structSynParticle.html">SynParticle</a> {
00022  
<a name="l00023"></a><a class="code" href="structSynParticle.html#m0">00023</a>         <span class="keywordtype">double</span> <a class="code" href="structSynParticle.html#m0">Z</a>; 
<a name="l00024"></a><a class="code" href="structSynParticle.html#m1">00024</a>         <span class="keywordtype">double</span> <a class="code" href="structSynParticle.html#m1">A</a>; 
00025         <span class="keywordtype">double</span> beta0;
00026         <span class="keywordtype">double</span> gamma0;
00027         <span class="keywordtype">double</span> eta0;        
00028 };   
00029 
00030 
00032 
<a name="l00033"></a><a class="code" href="classPic.html">00033</a> <span class="keyword">class </span><a class="code" href="classPic.html">Pic</a> {
00034  
00035  vector&lt;Particle&gt; pics;
00036  <span class="keywordtype">double</span> charge;   <span class="comment">// macro particle charge/qe</span>
00037  <a class="code" href="structSynParticle.html">SynParticle</a> *SP; <span class="comment">// Synchronous particle</span>
00038  FILE *out;       <span class="comment">// output file</span>
00039 
00040 <span class="keyword">public</span>:
<a name="l00042"></a><a class="code" href="classPic.html#m1">00042</a>  <span class="keywordtype">double</span> <a class="code" href="classPic.html#m0">z1</a>,<a class="code" href="classPic.html#m1">z2</a>;
00043 
00044  <a class="code" href="classPic.html">Pic</a>() {}
00045  <a class="code" href="classPic.html">Pic</a>(<a class="code" href="structSynParticle.html">SynParticle</a>* ptr ,<span class="keywordtype">double</span> q, <span class="keywordtype">int</span> n, string filename) : pics(n)
00046   { charge=q; SP=ptr; out=fopen(filename.c_str(),<span class="stringliteral">"w"</span>);}
00047  ~<a class="code" href="classPic.html">Pic</a>() { fclose(out); }
00048 
00049  <span class="keywordtype">double</span> get_charge() { <span class="keywordflow">return</span> charge; }
00050  <span class="keywordtype">int</span> get_size() { <span class="keywordflow">return</span> pics.size(); }
00051 
00052  <span class="comment">// Transverse distributions</span>
00053  
00055  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a5">waterbag_xy</a>(<span class="keywordtype">double</span> emittance_x, <span class="keywordtype">double</span> emittance_y, 
00056            <span class="keywordtype">double</span> alpha_x, <span class="keywordtype">double</span> beta_x,
00057            <span class="keywordtype">double</span> beta_x, <span class="keywordtype">double</span> beta_y, <span class="keywordtype">double</span> D0, <span class="keywordtype">double</span> Ds0, 
00058            <span class="keywordtype">double</span> centering, <span class="keywordtype">double</span> circum, <span class="keywordtype">double</span> zlm, <span class="keywordtype">double</span> chroma, <span class="keywordtype">double</span> tunex, <span class="keywordtype">long</span> *d);
00060  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a6">KV_xy</a>(<span class="keywordtype">double</span> emittance_x, <span class="keywordtype">double</span> emittance_y, 
00061             <span class="keywordtype">double</span> alpha_x, <span class="keywordtype">double</span> alpha_y,
00062             <span class="keywordtype">double</span> beta_x, <span class="keywordtype">double</span> beta_y, <span class="keywordtype">double</span> D0, <span class="keywordtype">double</span> Ds0, 
00063             <span class="keywordtype">double</span> centering, <span class="keywordtype">double</span> nres, <span class="keywordtype">double</span> circum, <span class="keywordtype">double</span> zlm, <span class="keywordtype">double</span> chroma, <span class="keywordtype">double</span> tunex, <span class="keywordtype">long</span> *d);
00065  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a7">SG</a>(<span class="keywordtype">double</span> emittance_x, <span class="keywordtype">double</span> emittance_y, 
00066          <span class="keywordtype">double</span> alpha_x, <span class="keywordtype">double</span> alpha_y,
00067          <span class="keywordtype">double</span> beta_x, <span class="keywordtype">double</span> beta_y, <span class="keywordtype">double</span> D0, <span class="keywordtype">double</span> Ds0, <span class="keywordtype">double</span> centering, <span class="keywordtype">long</span> *d); 
00069  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a8">Gauss_xy</a>(<span class="keywordtype">double</span> emittance_x, <span class="keywordtype">double</span> emittance_y, 
00070          <span class="keywordtype">double</span> alpha_x, <span class="keywordtype">double</span> alpha_y,
00071          <span class="keywordtype">double</span> beta_x, <span class="keywordtype">double</span> beta_y, <span class="keywordtype">double</span> D0, <span class="keywordtype">double</span> Ds0, <span class="keywordtype">double</span> centering, <span class="keywordtype">long</span> *d); 
00072 
00073  <span class="comment">// longitudinal distributions:</span>
00074 
00076  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a9">parabolic</a>(<span class="keywordtype">double</span> z0, <span class="keywordtype">double</span> zlm, <span class="keywordtype">double</span> dp0, <span class="keywordtype">long</span> Np, <span class="keywordtype">long</span> *d);
00078  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a10">parabolic_dc</a>(<span class="keywordtype">double</span> length, <span class="keywordtype">double</span> dp0, <span class="keywordtype">long</span> Np, <span class="keywordtype">long</span> *d);
00080  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a11">gaussz</a>(<span class="keywordtype">double</span> dp0, <span class="keywordtype">long</span> *d);
00082  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a12">coasting_beam</a>(<span class="keywordtype">long</span> Np, <span class="keywordtype">double</span> length, <span class="keywordtype">long</span> *d);
00084  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a13">bunch_gauss</a>(<span class="keywordtype">double</span> zlm, <span class="keywordtype">double</span> dp0, <span class="keywordtype">long</span> Np, <span class="keywordtype">double</span> circum, <span class="keywordtype">long</span> *d);
00086  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a14">bunch_const</a>(<span class="keywordtype">double</span> zlm, <span class="keywordtype">double</span> dp0, <span class="keywordtype">int</span> linrf, <span class="keywordtype">double</span> circum, <span class="keywordtype">long</span> Np, <span class="keywordtype">long</span> *d);
00088  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a15">barrier_air_bag</a>(<span class="keywordtype">double</span> zlm, <span class="keywordtype">double</span> dp0, <span class="keywordtype">long</span> Np, <span class="keywordtype">long</span> *d);
00090  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a16">bunch_air_bag</a>(<span class="keywordtype">double</span> zlm, <span class="keywordtype">double</span> dp0, <span class="keywordtype">double</span> circum, <span class="keywordtype">long</span> Np, <span class="keywordtype">long</span> *d); 
00091 
00092 
00094 
00095  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a17">print</a>(<span class="keywordtype">int</span> subset); 
00096 
00097  <span class="comment">// rms momenta:</span>
00098 
00099  <span class="keywordtype">double</span> rms_emittance_x();  
00100  <span class="keywordtype">double</span> rms_emittance_y();  
00101  <span class="keywordtype">double</span> x_rms();
00102  <span class="keywordtype">double</span> x_max();
00103  <span class="keywordtype">double</span> y_rms();
00104  <span class="keywordtype">double</span> y_max();
00105  <span class="keywordtype">double</span> z_mean();
00106  <span class="keywordtype">double</span> z_min();
00107  <span class="keywordtype">double</span> z_max();
00108  <span class="keywordtype">double</span> z2_mean();
00109  <span class="keywordtype">double</span> rms_z_width();
00110  <span class="keywordtype">double</span> pz_mean();
00111  <span class="keywordtype">double</span> pz2_mean();
00112  <span class="keywordtype">double</span> rms_momentum_spread();
00113  <span class="keywordtype">double</span> x2y2();
00114  <span class="keywordtype">double</span> xy();
00115  <span class="keywordtype">double</span> xzn(<span class="keywordtype">double</span> n, <span class="keywordtype">double</span> zlm);
00116  <span class="keywordtype">double</span> offset_x();
00117  <span class="keywordtype">double</span> offset_y();
00118  <span class="keywordtype">double</span> entropy(Grid2D&amp; xsys);
00119  
00120  <span class="comment">// single particle phase advance:</span>
00121 
00122  <span class="keywordtype">void</span> update_wavelength_h(<span class="keywordtype">double</span> ds, <span class="keywordtype">double</span> offset_x);
00123  <span class="keywordtype">void</span> update_wavelength_v(<span class="keywordtype">double</span> ds);
00124  <span class="keywordtype">double</span> <a class="code" href="classPic.html#a40">get_wavelength_h</a>(<span class="keywordtype">int</span> j);
00125  <span class="keywordtype">double</span> <a class="code" href="classPic.html#a41">get_wavelength_v</a>(<span class="keywordtype">int</span> j);
00126  <span class="keywordtype">double</span> rms_wavelength_h();
00127  <span class="keywordtype">double</span> rms_wavelength_v();
00128  
00129  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a44">store_old_coordinates</a>();
00130  <span class="keywordtype">double</span> get_phaseadvance_h(<span class="keywordtype">int</span> j);
00131  <span class="keywordtype">double</span> get_phaseadvance_v(<span class="keywordtype">int</span> j);
00132  <span class="keywordtype">double</span> rms_phaseadvance_h();
00133  <span class="keywordtype">double</span> rms_phaseadvance_v();
00134  
00136  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a49">transport</a>(<a class="code" href="classSectorMap.html">SectorMap</a>* M, <span class="keywordtype">double</span> boundary);
00138  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a50">kick</a>(Grid2D&amp; Ex, Grid2D&amp; Ey, <span class="keywordtype">double</span> ds);
00139  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a50">kick</a>(Grid3D&amp; Ex, Grid3D&amp; Ey, <span class="keywordtype">double</span> ds);
00141  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a50">kick</a>(<span class="keywordtype">double</span> fx, <span class="keywordtype">double</span> fy);
00143  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a53">cavity_kick</a>(<span class="keywordtype">double</span> voltage0, <span class="keywordtype">int</span> harmonic,<span class="keywordtype">double</span> R); 
00144  <span class="keywordtype">void</span> cavity_kick_linear(<span class="keywordtype">double</span> voltage0, <span class="keywordtype">int</span> harmonic,<span class="keywordtype">double</span> R); 
00146  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a55">barrier_kick</a>(<span class="keywordtype">double</span> zm1, <span class="keywordtype">double</span> zm2);
00148  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a50">kick</a>(<a class="code" href="classThinLens.html">ThinLens</a>&amp; M, <span class="keywordtype">double</span> ds);
00150  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a57">impedance_kick</a>(Grid1D&amp; kick, <span class="keywordtype">double</span> circum, <span class="keywordtype">double</span> ds);
00152  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a58">linear_SC_kick</a>(<span class="keywordtype">double</span> dQxm, <span class="keywordtype">double</span> dQym, <span class="keywordtype">double</span> tunex, <span class="keywordtype">double</span> tuney, 
00153                          Grid1D&amp; ldy, <span class="keywordtype">double</span> ldy0, 
00154                          Grid1D&amp; dipole_current_x, Grid1D&amp; dipole_current_y,
00155                          <span class="keywordtype">double</span> circum, <span class="keywordtype">double</span> ds);
00156  <span class="keywordtype">void</span> nonlinear_SC_kick(<span class="keywordtype">double</span> xrms, <span class="keywordtype">double</span> yrms, <span class="keywordtype">double</span> dQxm, <span class="keywordtype">double</span> dQym, <span class="keywordtype">double</span> tunex, <span class="keywordtype">double</span> tuney, 
00157                          Grid1D&amp; ldy, <span class="keywordtype">double</span> ldy0, 
00158                          <span class="keywordtype">double</span> circum, <span class="keywordtype">double</span> ds);
00159  <span class="keywordtype">void</span> dipole_kick_simple(<span class="keywordtype">double</span> dQxm, <span class="keywordtype">double</span> dQym, <span class="keywordtype">double</span> tunex, <span class="keywordtype">double</span> tuney, 
00160                          Grid1D&amp; ldy, <span class="keywordtype">double</span> ldy0, 
00161                          Grid1D&amp; dipole_current_x, Grid1D&amp; dipole_current_y,
00162                          <span class="keywordtype">double</span> circum, <span class="keywordtype">double</span> ds);
00164  <span class="keywordtype">double</span> <a class="code" href="classPic.html#a61">dipole_mod_kick</a>(<span class="keywordtype">double</span> t, <span class="keywordtype">double</span> ds, <span class="keywordtype">double</span> circum, <span class="keywordtype">double</span> theta, <span class="keywordtype">double</span> freq0, <span class="keywordtype">double</span> freq1, 
00165                         <span class="keywordtype">double</span> tend, <span class="keywordtype">int</span> n, <span class="keywordtype">long</span>* d);
00167  <span class="keywordtype">double</span> <a class="code" href="classPic.html#a61">dipole_mod_kick</a>(<span class="keywordtype">double</span> t, <span class="keywordtype">double</span> ds, <span class="keywordtype">double</span> circum, <span class="keywordtype">double</span> theta, <span class="keywordtype">double</span> freq, <span class="keywordtype">int</span> n);  
00169  <span class="keywordtype">double</span> <a class="code" href="classPic.html#a63">pickup_signal</a>(Grid1D&amp; dipole_current, <span class="keywordtype">double</span> circum, <span class="keywordtype">double</span> t);
00170  
00172  <span class="keywordtype">void</span> <a class="code" href="classPic.html#a64">langevin</a>(<span class="keywordtype">double</span> beta_fxy, <span class="keywordtype">double</span> beta_fz, <span class="keywordtype">double</span> Dxy, <span class="keywordtype">double</span> Dz, 
00173           <span class="keywordtype">double</span> ds, <span class="keywordtype">double</span> betx, <span class="keywordtype">double</span> bety, <span class="keywordtype">long</span>* d);
00174  
00175  <span class="comment">// grid to particle/particle to grid interpolations:</span>
00176 
00177  <span class="keywordtype">void</span> gatherZ(<span class="keywordtype">double</span> pic_charge,Grid1D&amp; target);
00178  <span class="keywordtype">void</span> gatherX(<span class="keywordtype">double</span> pic_charge,Grid1D&amp; target);
00179  <span class="keywordtype">void</span> gatherXs(<span class="keywordtype">double</span> pic_charge,Grid1D&amp; target);
00180  <span class="keywordtype">void</span> gatherY(<span class="keywordtype">double</span> pic_charge,Grid1D&amp; target);
00181  <span class="keywordtype">void</span> gatherXY(<span class="keywordtype">double</span> pic_charge,Grid2D&amp; target);
00182  <span class="keywordtype">void</span> gatherXYZ(<span class="keywordtype">double</span> pic_charge,Grid3D&amp; target);
00183  <span class="keywordtype">void</span> gatherXXs(<span class="keywordtype">double</span> pic_charge,Grid2D&amp; target);
00184  <span class="keywordtype">void</span> gatherZX(<span class="keywordtype">double</span> pic_charge,Grid2D&amp; target);
00185  <span class="keywordtype">void</span> gatherYYs(<span class="keywordtype">double</span> pic_charge,Grid2D&amp; target);
00186  <span class="keywordtype">void</span> gatherXsYs(<span class="keywordtype">double</span> pic_charge,Grid2D&amp; target);
00187  
00188  <span class="comment">// exchange of particles </span>
00189 
00190  vector&lt;Particle&gt; get_particles_left(<span class="keywordtype">double</span> length);
00191  vector&lt;Particle&gt; get_particles_right(<span class="keywordtype">double</span> length);
00192  <span class="keywordtype">void</span> add_particles(vector&lt;Particle&gt;&amp; part);
00193  
00194  <span class="keywordtype">void</span> periodic_bc(<span class="keywordtype">double</span> length);
00195  
00196 };
00197 
00198 
00199 
00200 
</pre></div><hr><address style="align: right;"><small>Generated on Wed Oct 14 14:27:07 2009 for Track by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3 </small></address>
</body>
</html>
